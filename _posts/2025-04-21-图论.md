---
title: "图论"
categories: [ds-algo]

math: true
layout: post
---

图论是离散数学的一个重要分支，在计算机科学、网络结构、路径规划、社交网络分析等领域有广泛应用。

---

## 一、图论的基本知识

**图（Graph）** 是由 **顶点（Vertex）** 和 **边（Edge）** 组成的数学结构，用于表示对象之间的关系。

**用途举例**：
  * 社交网络中的用户与好友关系
  * 地图中的城市与道路
  * 网络拓扑结构中的路由点和连接

---

## 二、图的组成

图通常用 $G = (V, E)$ 表示：

* $V$：顶点集合（Vertices），也叫“节点”；
* $E$：边集合（Edges），表示顶点之间的连接关系。

### 1. 顶点（Vertex）

* 图中的基本单位，用于表示对象或实体。
* 例如：城市、用户、网页等。

### 2. 边（Edge）

* 顶点之间的连接，用于表示关系或路径。
* 可分为：

  * **无向边（Undirected Edge）**：没有方向，连接是双向的。例如 A — B；
  * **有向边（Directed Edge）**：有方向，仅从一个顶点指向另一个。例如 A → B。

### 3. 边的权重（Weight）

* 某些图中的边可能带有权重，用于表示距离、时间、费用等量化信息，形成**加权图（Weighted Graph）**。
> 当一条边的权重大于 0（比如 2、5、100），我们称为正权边；
> 
>当一条边的权重小于 0（比如 -3、-1），我们称为负边权（或负权边）；

---

## 三、图的分类

| 分类依据   | 类型   | 说明               |
| ------ | ---- | ---------------- |
| 边是否有方向 | 无向图  | 所有边都是双向的         |
|        | 有向图  | 所有边都有方向          |
| 是否有环   | 有环图  | 存在从某个点出发可回到该点的路径 |
|        | 无环图  | 不存在环路，常见于树结构     |
| 是否有权重  | 加权图  | 边有权重值            |
|        | 非加权图 | 边无权重值            |

---

## 四、图的构造方式（实现方法）

图可以用多种方式在程序中构造，主要有以下几种：

### 1. 邻接矩阵（Adjacency Matrix）

* 用一个 $n \times n$ 的矩阵表示图，适用于稠密图。
* 每个单元表示顶点之间是否有边。

```python
# 0表示无边，1表示有边
graph = [
    [0, 1, 0],
    [1, 0, 1],
    [0, 1, 0]
]
```

* 特点：

  * 查询两点是否连通是 O(1)
  * 空间复杂度是 O(n²)

---

### 2. 邻接表（Adjacency List）

* 每个顶点维护一个链表，存储所有相邻的顶点。
* 更适合稀疏图。

```python
graph = {
    'A': ['B'],
    'B': ['A', 'C'],
    'C': ['B']
}
```

* 特点：

  * 节省空间，O(n + m)
  * 查询某一顶点的邻居效率高

---

### 3. 边列表（Edge List）

* 用一个列表直接存储所有的边，通常用于边排序、Kruskal 算法等。

```plaintext
[
  (A, B),
  (B, C)
]
```

* 特点：

  * 实现简单
  * 不适合频繁查询邻接关系

---

## 五、常见术语

| 术语   | 含义                       |
| ---- |--------------------------|
| 邻接点  | 与某顶点直接通过边相连的点            |
| 度数   | 与一个顶点相连的边数（入度、出度）        |
| 路径   | 一系列通过边连接的顶点序列            |
| 环    | 从某顶点出发回到自身的路径            |
| 负环    | 图中存在一个环形路径，使得这个环的总权重小于0 |
| 连通图  | 任意两点之间都有路径               |
| 基环树 | 带有恰好一个环的连通图             |

---

### 负环（Negative Weight Cycle）
负环是指：图中存在一个环形路径，使得这个环的总权重小于0。
也就是说，你可以一直绕这个环，路径总长度会无限减小！

> 负环意味着，从某个点出发，不断绕负环一圈又一圈，让总代价无限小（趋近负无穷），导致最短路径根本不存在！

---

### 连通图（Connected graph）

**无向图中的连通图。**
一个无向图是 **连通图**，当且仅当：

> **图中任意两个节点之间，都至少存在一条路径相通。**
>
>也就是说，从任意一个点出发，都能走到其它任意点。


**有向图中的连通图。**
有向图的“连通”有两种常见说法：

| 概念   | 定义                          | 判断方法                    |
| ---- |-----------------------------| ----------------------- |
| 强连通图 | 任意两个节点之间都存在双向路径。<br/>`u->v且v->u` | 正向 DFS/BFS + 反向 DFS/BFS |
| 弱连通图 | 忽略边的方向后，图是连通的。              | 转换为无向图，DFS/BFS 检查连通性    |

**总结对比：**

| 概念       | 含义            |
| -------- | ------------- |
| 连通图（无向）  | 任意两点有路径相通     |
| 强连通图（有向） | 任意两点双向可达      |
| 弱连通图（有向） | 忽略方向后连通       |
| 非连通图     | 存在至少一对节点之间无路径 |

> 如果一个图不是连通的，它会被分成若干个“连通的子图”，这些子图称为：**连通分量（Connected Components）**

---

**如何证明一个有向图是强连通的？**
1. **从任意一个节点 `u` 出发**，用 DFS 或 BFS 遍历整个图。
2. 如果从 `u` 能够访问到所有的节点，说明从 `u` 到其他所有节点都有路径。
3. 然后 **反转图**（即将所有边的方向倒过来），再从 `u` 出发，进行一次 DFS 或 BFS。
4. 如果在反转后的图中，所有节点也都能访问到，则图是强连通的。

**如何证明一个有向图是弱连通的？**
1. **忽略边的方向**，将图中的每一条边都看作无向边。
2. 然后检查这个无向图是否是连通的。可以使用 **DFS** 或 **BFS** 遍历图的节点。
3. 如果在无向图中，所有节点都可以访问到，则原图是弱连通的。

**证明有向图是强连通时，为什么只任意选择一个节点？**
> 因为强连通图的定义 本身就隐含了「任意两点都能互达」这一性质。

如果你能从一个节点 u 到达所有其他节点（正向）， 并且所有其他节点也能到达 u（反向）， 就能推出：任意两个节点之间都有路径连接，即满足强连通的定义。

更形式化的解释，设图中有 n 个节点，选定一个节点 u：

- 第一步：正向 DFS/BFS，从 `u` 出发，若能访问所有节点。说明：
`u → v` 对任意 `v` 成立。
- 第二步：反向图中从 `u` DFS/BFS，若还能访问所有节点。说明：
`v → u` 对任意 `v` 成立。 

---

### 基环树（Pseudotree）

**基环树（Pseudotree）** 是指一个 **有 `n` 个节点、`n` 条边的连通图**，图中 **恰好包含一个环**。其余边构成树结构，也就是说：

* 整体是一棵“树 + 1 条回边”。
* **去掉一条环上的边**，图变为一棵树。

**特点总结：**
> * 连通；
> * 有且仅有一个环；
> * 边数 = 点数；
> * 环外部分是树结构。

**结构与示意图**：
```
        1
       / \
      2 - 3
     /     \
    4       5
```

* 1-2-3-1 构成一个环；
* 4 是挂在 2 上的树节点；
* 5 是挂在 3 上的树节点；
* 去掉任意一条环上的边（如 1-3），变成树。

使用并查集判断基环树的环。
* 用并查集（Union Find）处理图的每条边；
* 若某条边连接了已经在一个集合中的两个点，则构成环；
* 恰好有一条这样的边，即可判断是基环树。

---

### 欧拉路径/回路（Euler Path/Circuit）

* **欧拉路径（Euler Path）**：一条经过图中**每条边恰好一次**的路径，起点和终点可以不同。
* **欧拉回路（Euler Circuit）或欧拉环（Euler Cycle）**：一条经过图中**每条边恰好一次**的**回路**（即起点等于终点）。

---

**判断欧拉路径与欧拉回路**

1. 无向图中的欧拉路径与欧拉回路
   * **存在欧拉回路的条件**：
     * 图是连通的（忽略孤立点），
     * 所有顶点的**度数为偶数**。
   * **存在欧拉路径但不是回路的条件**：
     * 图是连通的，
     * 恰有**两个顶点的度数为奇数**（路径的起点和终点）。
   * **其余情况**：无欧拉路径或回路。
2. 有向图中的欧拉路径与欧拉回路
   * **存在欧拉回路的条件**：
     * 图是**强连通的**（每个顶点都可以通过有向路径到达其他所有顶点），
     * 每个顶点的**入度等于出度**。
   * **存在欧拉路径但不是回路的条件**：
     * 图是**弱连通**（无向图视角连通），
     * 恰有一个顶点满足：出度比入度多 1（起点），
     * 恰有一个顶点满足：入度比出度多 1（终点），
     * 其他所有顶点满足：入度等于出度。
   * **其余情况**：无欧拉路径或回路。

| 图类型       | 欧拉回路条件          | 欧拉路径条件（非回路）               |
|-----------| --------------- | ------------------------- |
| 无向图       | 连通 + 所有顶点度数为偶数  | 连通 + 恰有两个奇度顶点             |
| 有向图       | 强连通 + 所有顶点入度=出度 | 弱连通 + 1个出度比入度多1，1个入度比出度多1 |

---
