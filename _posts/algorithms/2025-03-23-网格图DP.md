---
title: "动态规划全解：网格图DP全解"
categories: [algorithms]
tags: [algorithm]

math: true
layout: post
---

系统性介绍 **网格图 DP**（Grid DP），这类问题在动态规划题目中非常常见，尤其是路径、计数、最大和等问题。

---

## 网格 DP

网格 DP 指的是在一个二维网格（通常是 `m × n`）上进行动态规划。常见任务是从某个起点走到终点，或者在网格上进行某种状态转移。

典型场景：

* 从左上角 `(0,0)` 走到右下角 `(m-1,n-1)`，只能向下或向右移动。
* 网格中带有障碍物，或每个格子有权值，求路径的最优解。
* 统计不同路径数、最大/最小路径和。

---

## 常见模型

### 1. 最短/最长路径类

状态定义：

$$
dp[i][j] = 从起点走到 (i,j) 的最优值
$$

转移方程（仅能向下或向右移动）：

$$
dp[i][j] = f(dp[i-1][j], dp[i][j-1]) + grid[i][j]
$$

其中 $f$ 是 `min` 或 `max`。

---

**经典例题**

| 题号 | 题目 | 标签 |
|------|------|------|
| 64   | [最小路径和](https://leetcode.cn/problems/minimum-path-sum/) | 模板题 |
| 120  | [三角形最小路径和](https://leetcode.cn/problems/triangle/) | 提升题 |

---

### 2. 路径计数类

$$
dp[i][j] = 从起点到 (i,j) 的路径数
$$

转移方程：

$$
dp[i][j] = dp[i-1][j] + dp[i][j-1]
$$

边界条件：第一行和第一列只能从一个方向到达。

---

**经典例题**

| 题号  | 题目 | 标签 |
|-----|------|------|
| 62  | [不同路径](https://leetcode.cn/problems/unique-paths/) | 模板题 |

---

### 3. 障碍网格

如果 `(i,j)` 是障碍：

$$
dp[i][j] = 0
$$

否则和路径计数类相同。

---

**经典例题**

| 题号 | 题目 | 标签 |
|----|------|------|
| 63 | [不同路径 II](https://leetcode.cn/problems/unique-paths-ii/) | 模板题 |

---

### 4. 状态压缩优化

如果只依赖上方和左方，可以用一维数组优化空间：

```python
dp = [0] * n
dp[0] = 1
for i in range(m):
    for j in range(n):
        if grid[i][j] == 1:  # 障碍
            dp[j] = 0
        elif j > 0:
            dp[j] += dp[j-1]
```

---

## 典型代码模板

### 路径和问题

```python
def minPathSum(grid):
    m, n = len(grid), len(grid[0])
    dp = [[0] * n for _ in range(m)]
    dp[0][0] = grid[0][0]
    
    for i in range(1, m):
        dp[i][0] = dp[i-1][0] + grid[i][0]
    for j in range(1, n):
        dp[0][j] = dp[0][j-1] + grid[0][j]
    
    for i in range(1, m):
        for j in range(1, n):
            dp[i][j] = min(dp[i-1][j], dp[i][j-1]) + grid[i][j]
    
    return dp[-1][-1]
```

---

## 总结

* **核心思路**：每个格子的值取决于它的上方和左方。

* **常见变种**：
  * 路径条数（组合数 DP）
  * 路径最小/最大权值
  * 带障碍物
  * 状态压缩优化（一维 DP 或 利用原网格）

---
