---
title: "æ•°æ®ç»“æ„ï¼šå †/é˜Ÿåˆ—/æ ˆ/å•è°ƒæ ˆ"
categories: [ds-algo]

math: true
layout: post
---

> æœ¬æ–‡å±äº **æ•°æ®ç»“æ„ç³»åˆ—åšå®¢**ã€‚æœ¬ç³»åˆ—æ—¨åœ¨ç³»ç»Ÿæ¢³ç†å¸¸è§æ•°æ®ç»“æ„çš„åŸç†ã€å®ç°ä¸åº”ç”¨ï¼Œé€‚åˆåˆ·é¢˜ã€é¢è¯•åŠæ•™å­¦ä½¿ç”¨ã€‚

ğŸ”— **ç›®å½•å¯¼èˆªï¼š**
- [å‰ç¼€å’Œæ•°ç»„](/posts/å‰ç¼€å’Œ_å·®åˆ†_æ ‘çŠ¶_çº¿æ®µæ ‘/#å‰ç¼€å’Œæ•°ç»„)
- [å·®åˆ†æ•°ç»„](/posts/å‰ç¼€å’Œ_å·®åˆ†_æ ‘çŠ¶_çº¿æ®µæ ‘/#å·®åˆ†æ•°ç»„)
- [é˜Ÿåˆ—/æ ˆ](/posts/æ ˆ_é˜Ÿåˆ—_å•è°ƒæ ˆ_å †/#é˜Ÿåˆ—å’Œæ ˆ)
- [å•è°ƒæ ˆ](/posts/æ ˆ_é˜Ÿåˆ—_å•è°ƒæ ˆ_å †/#å•è°ƒæ ˆ)
- [å †(ä¼˜å…ˆçº§é˜Ÿåˆ—)](/posts/æ ˆ_é˜Ÿåˆ—_å•è°ƒæ ˆ_å †/#å †ä¼˜å…ˆçº§é˜Ÿåˆ—)
- [æ ‘çŠ¶æ•°ç»„](/posts/å‰ç¼€å’Œ_å·®åˆ†_æ ‘çŠ¶_çº¿æ®µæ ‘/#æ ‘çŠ¶æ•°ç»„)
- [çº¿æ®µæ ‘](/posts/å‰ç¼€å’Œ_å·®åˆ†_æ ‘çŠ¶_çº¿æ®µæ ‘/#çº¿æ®µæ ‘)
- [å¹¶æŸ¥é›†](/posts/å­—å…¸æ ‘_LRU_å¹¶æŸ¥é›†/#å¹¶æŸ¥é›†)
- [å­—å…¸æ ‘](/posts/å­—å…¸æ ‘_LRU_å¹¶æŸ¥é›†/#å­—å…¸æ ‘)
- [LRU(æœ€è¿‘æœ€å°‘ä½¿ç”¨)](/posts/å­—å…¸æ ‘_LRU_å¹¶æŸ¥é›†/#lru)

---

## é˜Ÿåˆ—å’Œæ ˆ

**æ ˆï¼ˆStackï¼‰ vs é˜Ÿåˆ—ï¼ˆQueueï¼‰ï¼š**

| ç‰¹æ€§        | æ ˆï¼ˆStackï¼‰                     | é˜Ÿåˆ—ï¼ˆQueueï¼‰               |
| --------- | ---------------------------- | ----------------------- |
| å­˜å–é¡ºåº      | åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰                   | å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰              |
| æ’å…¥æ“ä½œ      | `push(x)` æ”¾å…¥â€œæ ˆé¡¶â€             | `enqueue(x)` æ”¾å…¥â€œé˜Ÿå°¾â€     |
| åˆ é™¤æ“ä½œ      | `pop()` ä»â€œæ ˆé¡¶â€ç§»é™¤              | `dequeue()` ä»â€œé˜Ÿå¤´â€ç§»é™¤     |
| è®¿é—®æ–¹å¼      | åªèƒ½è®¿é—®æ ˆé¡¶                       | åªèƒ½è®¿é—®é˜Ÿå¤´                  |
| å¸¸ç”¨åœºæ™¯      | æ‹¬å·åŒ¹é…ã€è¡¨è¾¾å¼æ±‚å€¼ã€å›æº¯ç­‰               | æ’é˜Ÿç³»ç»Ÿã€BFSéå†ã€ä»»åŠ¡è°ƒåº¦ç­‰        |
| Python å®ç° | `list` æˆ– `collections.deque` | `collections.deque`ï¼ˆæ¨èï¼‰ |

---

**é˜Ÿåˆ—**

**ç‰¹ç‚¹ï¼š**
* **å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰**
* ç±»æ¯”ï¼šæ’é˜Ÿç³»ç»Ÿã€æ‰“å°é˜Ÿåˆ—

**Python å®ç°ï¼ˆæ¨èä½¿ç”¨ `collections.deque`ï¼‰ï¼š**
```python
from collections import deque

queue = deque()

queue.append(1)       # å…¥é˜Ÿï¼ˆå°¾éƒ¨ï¼‰
queue.append(2)
front = queue[0]      # æŸ¥çœ‹é˜Ÿå¤´
queue.popleft()       # å‡ºé˜Ÿï¼ˆå¤´éƒ¨ï¼‰
```

* `append(x)` å…¥é˜Ÿï¼ˆå³ç«¯ï¼‰
* `popleft()` å‡ºé˜Ÿï¼ˆå·¦ç«¯ï¼‰

`collections.deque`åŒæ ·å¯ç”¨äºå®ç°â€œ**åŒç«¯é˜Ÿåˆ—**â€ï¼š
```python
queue.appendleft(x)   # å·¦è¾¹å…¥é˜Ÿ
queue.pop()           # å³è¾¹å‡ºé˜Ÿ
```

---

**æ ˆ**

**ç‰¹ç‚¹ï¼š**
* **åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰**
* ç±»æ¯”ï¼šç›˜å­å †ã€æ’¤é”€æ“ä½œ

**Python å®ç°ï¼ˆæ¨èä½¿ç”¨ `list`ï¼‰ï¼š**
```python
stack = []

stack.append(1)    # push å…¥æ ˆ
stack.append(2)
top = stack[-1]    # æŸ¥çœ‹æ ˆé¡¶
stack.pop()        # pop å‡ºæ ˆ
```

* `append(x)` å…¥æ ˆ
* `pop()` å‡ºæ ˆ
* `stack[-1]` æŸ¥çœ‹æ ˆé¡¶

---

## å•è°ƒæ ˆ

å•è°ƒæ ˆæ˜¯æŒ‡æ ˆå†…å…ƒç´ å•è°ƒé€’å¢æˆ–é€’å‡çš„æ ˆç»“æ„ã€‚

**å¸¸è§åº”ç”¨åœºæ™¯ï¼š**

| åº”ç”¨åœºæ™¯      | ç®€è¦æè¿°                     |
| --------- | ------------------------ |
| ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼ˆæˆ–æ›´å°å…ƒç´ ï¼‰ | ä»ä¸€ä¸ªæ•°ç»„ä¸­æ‰¾åˆ°æ¯ä¸ªå…ƒç´ å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„æ•°   |
| æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ | æ±‚è§£æ¯æ ¹æŸ±å­å·¦å³ç¬¬ä¸€ä¸ªæ¯”å®ƒçŸ®çš„æŸ±å­ï¼Œè®¡ç®—æœ€å¤§é¢ç§¯ |
| æ»‘åŠ¨çª—å£æœ€å€¼    | å•è°ƒé˜Ÿåˆ—å˜å½¢                   |
| æŸä¸ªå…ƒç´ çš„å·¦/å³è¾¹ç•Œ | æ‰¾åˆ°æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°/å¤§çš„æ•°    |

**å•è°ƒé€’å¢ï¼ˆé€’å‡ï¼‰æ ˆï¼š**

| ç±»å‹    | ç‰¹ç‚¹                | é€‚ç”¨åœºæ™¯                |
| ----- | ----------------- | ------------------- |
| å•è°ƒé€’å¢æ ˆ | æ ˆå†…å…ƒç´ ä»æ ˆåº•åˆ°æ ˆé¡¶é€’å¢ï¼ˆå°â†’å¤§ï¼‰ | å¯»æ‰¾**ä¸‹ä¸€ä¸ªæ›´å°å…ƒç´ **ã€ç»´æŠ¤æœ€å°å€¼ |
| å•è°ƒé€’å‡æ ˆ | æ ˆå†…å…ƒç´ ä»æ ˆåº•åˆ°æ ˆé¡¶é€’å‡ï¼ˆå¤§â†’å°ï¼‰ | å¯»æ‰¾**ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ **ã€ç»´æŠ¤æœ€å¤§å€¼ |

**ä¸¾ä¾‹è¯´æ˜ï¼š**
ä»¥æ•°ç»„ `[2, 1, 5, 6, 2, 3]` ä¸ºä¾‹ï¼Œ**å¯»æ‰¾æ¯ä¸ªå…ƒç´ å³ä¾§ç¬¬ä¸€ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ **ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è®°ä¸º -1ã€‚

ç»´æŠ¤ä¸€ä¸ª **å•è°ƒé€’å‡æ ˆ**ï¼Œæ ˆä¸­å­˜çš„æ˜¯**ç´¢å¼•**ã€‚éå†æ•°ç»„æ—¶ï¼Œå¦‚æœå½“å‰å…ƒç´ æ¯”æ ˆé¡¶å¯¹åº”çš„å…ƒç´ å¤§ï¼Œå°±è¯´æ˜æ‰¾åˆ°äº†â€œä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´ â€ã€‚

---

### ç®—æ³•è¿‡ç¨‹

è¾“å…¥æ•°ç»„ï¼š`nums = [2, 1, 5, 6, 2, 3]`

éå†è¿‡ç¨‹ï¼š

1. i = 0, nums\[0] = 2
   â†’ æ ˆç©ºï¼Œå…¥æ ˆ \[0]

2. i = 1, nums\[1] = 1
   â†’ æ ˆé¡¶ nums\[0]=2 > 1ï¼Œä¸æ»¡è¶³æ¡ä»¶ï¼Œå…¥æ ˆ \[0, 1]

3. i = 2, nums\[2] = 5

   * æ ˆé¡¶ nums\[1]=1 < 5 â†’ å¼¹å‡ºï¼Œres\[1] = 5
   * æ ˆé¡¶ nums\[0]=2 < 5 â†’ å¼¹å‡ºï¼Œres\[0] = 5
     â†’ å…¥æ ˆ \[2]

4. i = 3, nums\[3] = 6

   * æ ˆé¡¶ nums\[2]=5 < 6 â†’ å¼¹å‡ºï¼Œres\[2] = 6
     â†’ å…¥æ ˆ \[3]

5. i = 4, nums\[4] = 2
   â†’ æ ˆé¡¶ nums\[3]=6 > 2ï¼Œä¸å¼¹å‡ºï¼Œå…¥æ ˆ \[3, 4]

6. i = 5, nums\[5] = 3

   * æ ˆé¡¶ nums\[4]=2 < 3 â†’ å¼¹å‡ºï¼Œres\[4] = 3
     â†’ æ ˆé¡¶ nums\[3]=6 > 3ï¼Œä¸å¼¹å‡ºï¼Œå…¥æ ˆ \[3, 5]

æœ€ç»ˆç»“æœï¼š`res = [5, 5, 6, -1, 3, -1]`

---

### Python å®ç°

```python
def next_greater(nums):
    res = [-1] * len(nums)
    stack = []
    for i, num in enumerate(nums):
        while stack and nums[i] > nums[stack[-1]]:
            idx = stack.pop()
            res[idx] = nums[i]
        stack.append(i)
    return res
```

### ç»å…¸ä¾‹é¢˜
* [496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I](https://leetcode.cn/problems/next-greater-element-i/) 
* [503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II](https://leetcode.cn/problems/next-greater-element-ii/)
* [84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode.cn/problems/largest-rectangle-in-histogram/)
* [42. æ¥é›¨æ°´](https://leetcode.cn/problems/trapping-rain-water/)
* [239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼](https://leetcode.cn/problems/sliding-window-maximum/)

---


## å †(ä¼˜å…ˆçº§é˜Ÿåˆ—)

å †æ˜¯ä¸€ç§**å®Œå…¨äºŒå‰æ ‘**ï¼Œæ»¡è¶³ç‰¹å®šçš„é¡ºåºæ€§è´¨ï¼š

* **å¤§é¡¶å †ï¼ˆMax-Heapï¼‰**ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼ â‰¥ å…¶å­èŠ‚ç‚¹çš„å€¼ã€‚
* **å°é¡¶å †ï¼ˆMin-Heapï¼‰**ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„å€¼ â‰¤ å…¶å­èŠ‚ç‚¹çš„å€¼ã€‚

å †å¸¸ç”¨äºå®ç°**ä¼˜å…ˆé˜Ÿåˆ—**ï¼Œå¯ä»¥åœ¨ `O(log n)` æ—¶é—´å†…å®Œæˆæ’å…¥å’Œåˆ é™¤æœ€å¤§/æœ€å°å…ƒç´ ã€‚

**å †çš„åŸºæœ¬æ“ä½œï¼š**

| æ“ä½œ          | æ—¶é—´å¤æ‚åº¦    | æè¿°            |
| ----------- | -------- | ------------- |
| æ’å…¥ï¼ˆpushï¼‰    | O(log n) | å°†å…ƒç´ æ’å…¥å †ä¸­ï¼Œå‘ä¸Šè°ƒæ•´å † |
| å¼¹å‡ºï¼ˆpopï¼‰     | O(log n) | åˆ é™¤å †é¡¶å…ƒç´ ï¼Œå‘ä¸‹è°ƒæ•´å †  |
| æŸ¥çœ‹å †é¡¶ï¼ˆpeekï¼‰  | O(1)     | æŸ¥çœ‹æœ€å¤§æˆ–æœ€å°å…ƒç´      |
| å»ºå †ï¼ˆheapifyï¼‰ | O(n)     | å°†ä¸€ä¸ªæ— åºæ•°ç»„å»ºæˆå †ç»“æ„  |

---

### Pythonçš„`heapq`

* é»˜è®¤å®ç°çš„æ˜¯**å°é¡¶å †**
* è‹¥éœ€å¤§é¡¶å †ï¼šæ’å…¥å…ƒç´ æ—¶å–è´Ÿå€¼ `-x`ï¼Œå–å‡ºæ—¶å†å–è´Ÿ

**å¸¸ç”¨ API æ€»è§ˆï¼š**

| å‡½æ•°å                             | è¯´æ˜                     |
| ------------------------------- | ---------------------- |
| `heapq.heapify(list)`           | åŸåœ°å°†åˆ—è¡¨è½¬ä¸ºå †ç»“æ„ï¼ˆå°é¡¶å †ï¼‰        |
| `heapq.heappush(heap, item)`    | å‘å †ä¸­æ’å…¥ä¸€ä¸ªå…ƒç´               |
| `heapq.heappop(heap)`           | å¼¹å‡ºæœ€å°çš„å…ƒç´                 |
| `heapq.heappushpop(heap, item)` | å…ˆ push å popï¼ˆæ•ˆç‡æ¯”åˆ†åˆ«è°ƒç”¨é«˜ï¼‰ |
| `heapq.heapreplace(heap, item)` | å…ˆ pop å pushï¼ˆæ•ˆç‡æ¯”åˆ†åˆ«è°ƒç”¨é«˜ï¼‰ |
| `heapq.nlargest(k, iterable)`   | å–å‰ k å¤§                 |
| `heapq.nsmallest(k, iterable)`  | å–å‰ k å°                 |


```python
import heapq

# å°é¡¶å †
heap = []
heapq.heappush(heap, 5)
heapq.heappush(heap, 2)
heapq.heappop(heap)  # 2

# å¤§é¡¶å †
max_heap = []
heapq.heappush(max_heap, -5)
heapq.heappush(max_heap, -2)
-heapq.heappop(max_heap)  # 5
```

---

### å †æ’åºç®€ä»‹

å †æ’åºåˆ©ç”¨å †çš„æ€§è´¨æ¥è¿›è¡Œæ’åºï¼Œæ—¶é—´å¤æ‚åº¦ä¸º `O(n log n)`ï¼Œä¸ç¨³å®šæ’åºã€‚

**æ’åºæµç¨‹ï¼ˆå¤§é¡¶å †ï¼‰**ï¼š

1. å»ºå †ï¼ˆå¤§é¡¶å †ï¼‰
2. ä¸æ–­å°†å †é¡¶å…ƒç´ ä¸æœ«å°¾å…ƒç´ äº¤æ¢ï¼Œå¹¶è°ƒæ•´å‰©ä½™éƒ¨åˆ†ä¸ºå¤§é¡¶å †

```python
def heap_sort(nums):
    # ----------- å»ºç«‹å¤§é¡¶å † -----------
    def heapify(nums, n, i):
        largest = i  # åˆå§‹åŒ–æœ€å¤§å€¼ä¸ºå½“å‰æ ¹
        left = 2 * i + 1  # å·¦å­©å­
        right = 2 * i + 2  # å³å­©å­

        # å¦‚æœå·¦å­©å­å­˜åœ¨ä¸”æ¯”å½“å‰æœ€å¤§è¿˜å¤§
        if left < n and nums[left] > nums[largest]:
            largest = left

        # å¦‚æœå³å­©å­å­˜åœ¨ä¸”æ¯”å½“å‰æœ€å¤§è¿˜å¤§
        if right < n and nums[right] > nums[largest]:
            largest = right

        # å¦‚æœæœ€å¤§å€¼ä¸æ˜¯æ ¹ï¼Œäº¤æ¢å¹¶ç»§ç»­ heapify
        if largest != i:
            nums[i], nums[largest] = nums[largest], nums[i]
            heapify(nums, n, largest)

    n = len(nums)

    # ----------- ç¬¬ä¸€æ­¥ï¼šå»ºå † -----------
    for i in range(n // 2 - 1, -1, -1):  # ä»æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹
        heapify(nums, n, i)

    # ----------- ç¬¬äºŒæ­¥ï¼šæ’åº -----------
    for i in range(n - 1, 0, -1):
        # å½“å‰å †é¡¶æ˜¯æœ€å¤§å€¼ï¼Œäº¤æ¢åˆ°æœ«å°¾
        nums[0], nums[i] = nums[i], nums[0]
        # é‡æ–°è°ƒæ•´å †
        heapify(nums, i, 0)
```

### ç»å…¸ä¾‹é¢˜
- [1353. æœ€å¤šå¯ä»¥å‚åŠ çš„ä¼šè®®æ•°ç›®](https://leetcode.cn/problems/maximum-number-of-events-that-can-be-attended/)
- [2163. åˆ é™¤å…ƒç´ åå’Œçš„æœ€å°å·®å€¼](https://leetcode.cn/problems/minimum-difference-in-sums-after-removal-of-elements/)

---
