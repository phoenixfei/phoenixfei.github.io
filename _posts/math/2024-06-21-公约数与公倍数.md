---
title: "从辗转相除法到最小公倍数"
categories: [math]

math: true
layout: post
---

最大公约数（GCD）和最小公倍数（LCM）是整数运算中最基本且常用的数论工具，广泛用于整除判断与数值关系建模。

---

## GCD与LCM介绍

Greatest Common Divisor，最大公约数

两个整数 $a$ 和 $b$ 的最大公约数（GCD）是能同时整除这两个数的最大正整数，记作：

$$
\gcd(a, b)
$$

---

Least Common Multiple，最小公倍数

两个整数 $a$ 和 $b$ 的最小公倍数（LCM）是能被它们同时整除的最小正整数，记作：

$$
\text{lcm}(a, b)
$$

---

LCM 与 GCD 的关系公式

设 $a$ 和 $b$ 是两个正整数，
它们的最大公约数为 $\gcd(a, b)$，最小公倍数为 $\text{lcm}(a, b)$，则有：

$$
\text{lcm}(a, b) \times \gcd(a, b) = a \times b
$$

或者换一种常见形式：

$$
\text{lcm}(a, b) = \frac{a \times b}{\gcd(a, b)}
$$

---

## 辗转相除法

辗转相除法是一种用于计算两个整数最大公约数（GCD）的高效算法，基于一个非常简洁而强大的性质：

对于任意两个正整数 $a$ 和 $b$（假设 $a \geq b$），有：

$$
\gcd(a, b) = \gcd(b, a \bmod b)
$$

这个过程会不断地用较小的数去除较大的数，并把余数作为新的除数，直到余数为 0。最后的非零除数就是 GCD。

---

**算法流程：**

以计算 $\gcd(48, 18)$ 为例，来看具体步骤：

1. $48 \mod 18 = 12$，变为 $\gcd(18, 12)$
2. $18 \mod 12 = 6$，变为 $\gcd(12, 6)$
3. $12 \mod 6 = 0$，结束。结果是 **6**

最终结果：GCD = 6

---

## Python 实现

迭代版本
```python
def gcd(a, b):
    while b:
        a, b = b, a % b
    return a
```

递归版本
```python
def gcd(a, b):
    return a if b == 0 else gcd(b, a % b)
```

内置函数
```python
import math

print(math.gcd(48, 18))  # 6
print(math.lcm(48, 18))  # 144
```

---

辗转相除法的时间复杂度是：

$$
O(\log \min(a, b))
$$

这是因为每次操作都会将较大数减小，且它和斐波那契数列有很深的联系。最坏情况下的输入对是连续的斐波那契数（比如 21 和 13），此时迭代次数最多。

---

## 更相减损术

* 基本思想是：不断用两数中的较大数减去较小数，直到两数相等。
* 时间复杂度远高于辗转相除法，在接近的数值时性能极差。


* **更相减损术计算 $\gcd(48, 18)$**：

```text
48 - 18 = 30  
30 - 18 = 12  
18 - 12 = 6  
12 - 6 = 6  
6 - 6 = 0  
=> GCD = 6（共5次）
```

* **辗转相除法仅需 3 步！**

---

## 辗转相除法证明

证明：

$$
\gcd(a, b) = \gcd(b, a \bmod b)
$$

我们要证明的核心是：

$$
\text{设 } r = a \bmod b, \text{则 } \gcd(a, b) = \gcd(b, r)
$$

---

**几何/集合视角**

我们定义：

* $D(a, b)$：能同时整除 $a$ 和 $b$ 的所有正整数的集合；
* $D(b, r)$：能同时整除 $b$ 和 $r = a \bmod b $ 的所有正整数的集合。

我们要证明的是：

> $D(a, b) = D(b, r)$，即这两个集合的最大值（最大公约数）是一样的。

---

**形式推理**

假设：

$$
a = bq + r \quad \text{（整除关系）}
$$

我们来观察：什么数能同时整除 $a$ 和 $b$？

---

第一步：若 $d \mid a$ 且 $d \mid b$，则 $d \mid r$

因为：

$$
r = a - bq
$$

而 $d \mid a$，$d \mid b$，说明 $d$ 也能整除 $r = a - bq$。

所以：

$$
\begin{align}
\text{若 } d \mid a \text{ 且 } d \mid b &\Rightarrow d \mid r \\
&\Rightarrow d \mid b \text{ 且 } d \mid r \\
&\Rightarrow d \in D(b, r)
\end{align}
$$

也就是说：**$D(a, b) \subseteq D(b, r)$**

---

第二步：反过来，若 $d \mid b$ 且 $d \mid r$，那 $d \mid a$

因为：

$$
\begin{aligned}
a &= bq + r \\
&\Rightarrow d \mid b \text{ 且 } d \mid r \Rightarrow d \mid a \\
&\Rightarrow d \in D(a, b)
\end{aligned}
$$

所以：**$D(b, r) \subseteq D(a, b)$**

---

**结论：**

$$
\begin{aligned}
D(a, b) &= D(b, r) \\
&\Rightarrow \gcd(a, b) = \gcd(b, r) \\
&\Rightarrow \text{辗转相除法成立}
\end{aligned}
$$

---

## LCM关系公式证明

证明：

$$
\text{lcm}(a, b) = \frac{a \cdot b}{\gcd(a, b)}
$$

---

**基本定义**

* **最大公约数** $\gcd(a, b)$：能同时整除 $a$、$b$ 的**最大**正整数。
* **最小公倍数** $\text{lcm}(a, b)$：能被 $a$、$b$ 同时整除的**最小**正整数。

---

**推导思路**

我们从一个最基本的数论分解出发：

> 任意两个整数 $a$、$b$，我们可以把它们写成「最大公约数 × 互质部分」的形式：

$$
a = d \cdot m,\quad b = d \cdot n,\quad \text{其中 } d = \gcd(a, b)
$$

因为我们已经提取了所有公共因子，所以 $m$ 和 $n$ 一定**互质**（$\gcd(m, n) = 1$）。

---

**详细推导步骤**

第一步：用最大公约数表示 $a$ 和 $b$

设：

$$
a = d \cdot m,\quad b = d \cdot n,\quad \text{其中 } d = \gcd(a, b)
$$

此时 $m$、$n$ 互质。

---

第二步：写出 $a \cdot b$

$$
a \cdot b = (d \cdot m)(d \cdot n) = d^2 \cdot m \cdot n
$$

---

第三步：考虑最小公倍数的构造方式

最小公倍数 $L$ 是同时能被 $a$、$b$ 整除的最小正整数。

显然：

$$
L = d \cdot m \cdot n
$$

为什么？因为：

* $a = d \cdot m$，所以 $L = d \cdot m \cdot n$ 是 $a$ 的倍数；
* $b = d \cdot n$，同理 $L$ 也是 $b$ 的倍数；
* 且 $m$、$n$ 互质，所以这是最小的共同倍数。

---

第四步：整理为公式

我们已经有：

* $a \cdot b = d^2 \cdot m \cdot n$
* $\text{lcm}(a, b) = d \cdot m \cdot n$

所以：

$$
\text{lcm}(a, b) = \frac{a \cdot b}{\gcd(a, b)}
$$

---
